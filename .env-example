# Environment Configuration
# Copy this file to .env and adjust values for your environment

# Application
# Application environment (development, production, test)
NODE_ENV=development
# Application port - the port on which the server will listen
PORT=3000
# Application name - used for logging, monitoring, and identification
APP_NAME=nestjs-app

# CORS Configuration
# Comma-separated list of allowed origins
# Development: localhost URLs are used by default if not specified
# Production: MUST specify exact HTTPS domains (comma-separated)
# Example: https://yourdomain.com,https://app.yourdomain.com
ALLOWED_ORIGINS=https://yourdomain.com
# Allow credentials (cookies, authorization headers) in CORS requests
# Set to 'true' or 'false' (default: false)
# Only enable if you need cookies or Authorization headers from frontend
CORS_CREDENTIALS=false

# Rate Limiting Configuration
# Time window in milliseconds during which requests are counted (default: 60000 = 1 minute)
THROTTLE_TTL=60000
# Maximum requests allowed per time window (default: 100)
THROTTLE_LIMIT=100

# Logging Configuration
# Log level - determines which log messages are displayed
# Levels: trace < debug < info < warn < error < fatal
# Default: 'info' (development: 'debug', production: 'info')
# Development: Use 'debug' to see more details during development
# Production: Use 'info' or 'warn' to reduce log volume
LOG_LEVEL=info
# Enable pretty printing for human-readable logs (development only)
# Set to 'true' or 'false' (default: 'false')
# Development: 'true' for readable terminal output
# Production: 'false' for structured JSON (required for Grafana Loki/Promtail)
LOG_PRETTY=false

# Security Configuration
# Admin secret key - used for admin authentication and secure operations
# Generate a strong secret using: openssl rand -hex 32
# Default: not set (must be provided via environment variable)
# Security: MUST be set in production - never commit secrets to version control
# Use different secrets for each environment (development, staging, production)
ADMIN_SECRET="your-strong-secret-here"


# Database Configuration
# PostgreSQL database host - server hostname or IP address
# Default: 'localhost' (standard for local development)
# Local development: 'localhost' (when running PostgreSQL locally)
# Docker Compose: 'postgres' (use service name for Docker networking)
# Docker (host access): 'host.docker.internal' (to access host machine from container)
# Example: DB_HOST=postgres.example.com
DB_HOST=localhost

# PostgreSQL database port - standard PostgreSQL port is 5432
# Default: 5432
# Override if using non-standard port (e.g., 5433)
# Example: DB_PORT=5433
DB_PORT=5432

# Database username - PostgreSQL user for authentication
# Default: 'postgres' (standard default PostgreSQL user)
# Override with your application-specific database user
# Example: DB_USERNAME=feedbackx_user
DB_USERNAME=postgres

# Database password - PostgreSQL user password
# Default: 'postgres' (CHANGE THIS IN PRODUCTION)
# Security: MUST be set in production - never commit passwords to version control
# Use strong passwords in production (minimum 16 characters recommended)
# Example: DB_PASSWORD=secure-password-123
DB_PASSWORD=postgres

# Database name - name of the PostgreSQL database to connect to
# Default: 'nestjs-app' (or 'feedbackx' for this project)
# Change to match your application name
# Example: DB_DATABASE=feedbackx
DB_DATABASE=feedbackx

# Auto-synchronize database schema - automatically syncs entity changes to database
# WARNING: Should be false in production - only use in development/test
# Development: 'true' for rapid development (auto-sync changes, no migrations needed)
# Production: ALWAYS 'false' - use migrations instead to prevent data loss
# Test: 'true' for automatic test database setup
# Set to 'true' or 'false' (default varies by environment: dev/test=true, prod=false)
# Example: DB_SYNCHRONIZE=false
DB_SYNCHRONIZE=true

# Connection pool maximum connections - maximum number of connections in the pool
# Default: 20 (good balance for most applications)
# Tune based on database server capacity and application load
# Higher values for high-traffic applications (check PostgreSQL max_connections setting)
# Example: DB_POOL_MAX=50
DB_POOL_MAX=20

# Connection pool minimum connections - minimum number of connections to maintain
# Default: 5 (keeps warm connections ready for faster response)
# Higher values = faster initial queries (connections already open)
# Lower values = less resource usage (fewer idle connections)
# Example: DB_POOL_MIN=10
DB_POOL_MIN=5

# Connection pool idle timeout - time in milliseconds before closing idle connections
# Default: 30000 (30 seconds)
# Idle connections are closed after this timeout to free resources
# Increase for applications with periodic bursts (keeps connections longer)
# Decrease for applications with steady traffic (releases connections faster)
# Example: DB_POOL_IDLE_TIMEOUT=60000 (1 minute)
DB_POOL_IDLE_TIMEOUT=30000

# Connection pool connection timeout - time in milliseconds to wait for new connection
# Default: 10000 (10 seconds)
# Throws error if connection cannot be established within this time
# Increase if database is slow to respond (network latency, overloaded DB)
# Decrease to fail fast if database is unreachable
# Example: DB_POOL_CONNECTION_TIMEOUT=20000 (20 seconds)
DB_POOL_CONNECTION_TIMEOUT=10000

# Query timeout - time in milliseconds before query times out
# Default: 30000 (30 seconds)
# Prevents long-running queries from blocking the application
# Increase for complex analytical queries or bulk operations
# Decrease for fast OLTP workloads (fail fast on slow queries)
# Example: DB_QUERY_TIMEOUT=60000 (1 minute)
DB_QUERY_TIMEOUT=30000

# Infrastructure Configuration (Development/Demo Only)
# These variables are used by Docker Compose for infrastructure setup
# They are NOT used by the application - only for docker-compose.yml
# For production, configure these values in your orchestration platform

# pgAdmin Configuration (Development Tool)
# pgAdmin email - default admin email for pgAdmin web interface
# Default: 'admin@example.com'
# Change this to your preferred email for pgAdmin login
# Example: PGADMIN_EMAIL=admin@yourdomain.com
PGADMIN_EMAIL=admin@example.com

# pgAdmin port - port for pgAdmin web interface
# Default: 5050 (accessible at http://localhost:5050)
# Change if port 5050 is in use or conflicts with other services
# Example: PGADMIN_PORT=5051
PGADMIN_PORT=5050

# Application Port (Docker Compose)
# External port for the NestJS application API
# Default: 3000 (accessible at http://localhost:3000)
# Change if port 3000 is in use or conflicts with other services
# Note: Internal container port is always 3000, only host port is configurable
# Example: APP_PORT=8080 (then access at http://localhost:8080)
APP_PORT=3000

# Grafana Port (Docker Compose)
# External port for Grafana web interface
# Default: 3001 (accessible at http://localhost:3001)
# Change if port 3001 is in use or conflicts with other services
# Note: Internal container port is always 3000, only host port is configurable
# Example: GRAFANA_PORT=3002 (then access at http://localhost:3002)
GRAFANA_PORT=3001
